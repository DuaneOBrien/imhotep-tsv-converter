language: java
jdk:
    - oraclejdk7

script: mvn install

install:
    - wget https://s3-us-west-2.amazonaws.com/imhotep-build/install-imhotep-maven-local.sh 
    - bash install-imhotep-maven-local.sh

before_deploy:
    - mkdir deploy
    - cp */target/*builder*.* deploy/
    - cp pom.xml deploy/imhotep-tsv-converter.pom
    - cp index-builder-util/pom.xml deploy/index-builder-util.pom
    - cp tsv-converter/pom.xml deploy/tsv-converter.pom

deploy:
    provider: s3
    access_key_id: AKIAID3AAXWWTV2KQYEA
    secret_access_key:
      secure: Q/sL14YsB/ouKeY2vHJaYb6QUV4ZBTtBH1VY9e9T2SBqn2n+m/SeII/Z6PwQuPwSE4L+LdpmXrVydRimRHf2PI9NxDqeZPjqXNWSxK+/S/2Y+lJ2ikOnOEfvOOfvxKwjlsKm6sXrWwbczARJhwepnJj7nXs1W0S4amysmPpWIIc=
    bucket: imhotep-build
    local-dir: deploy
    skip_cleanup: true
    region: us-west-2
